<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Portal do Aluno - Villa Metal</title>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    
    body {
      background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
      color: #f1f5f9;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
    
    .navbar {
      background-color: rgba(0, 0, 0, 0.8);
      padding: 1rem 2rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
    }
    
    .navbar h2 {
      color: #f8fafc;
      font-size: 1.5rem;
    }
    
    .navbar button {
      background-color: #dc2626;
      color: white;
      border: none;
      padding: 0.5rem 1rem;
      border-radius: 4px;
      cursor: pointer;
      font-weight: bold;
      transition: background-color 0.3s;
    }
    
    .navbar button:hover {
      background-color: #b91c1c;
    }
    
    .login-container {
      max-width: 400px;
      margin: 2rem auto;
      padding: 2rem;
      background-color: rgba(255, 255, 255, 0.1);
      border-radius: 10px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
      backdrop-filter: blur(10px);
    }
    
    .login-container h2 {
      text-align: center;
      margin-bottom: 1.5rem;
      color: #f8fafc;
      font-size: 1.8rem;
    }
    
    .login-container h3 {
      margin-bottom: 1rem;
      color: #e2e8f0;
      text-align: center;
    }
    
    form {
      margin-bottom: 2rem;
      padding: 1.5rem;
      background-color: rgba(255, 255, 255, 0.05);
      border-radius: 8px;
    }
    
    input {
      width: 100%;
      padding: 0.8rem;
      margin-bottom: 1rem;
      border: 1px solid #4b5563;
      border-radius: 4px;
      background-color: rgba(15, 23, 42, 0.7);
      color: #f1f5f9;
    }
    
    input::placeholder {
      color: #94a3b8;
    }
    
    button[type="submit"] {
      width: 100%;
      padding: 0.8rem;
      background-color: #dc2626;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-weight: bold;
      transition: background-color 0.3s;
    }
    
    button[type="submit"]:hover {
      background-color: #b91c1c;
    }
    
    .google-btn {
      width: 100%;
      padding: 0.8rem;
      background-color: #4285F4;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-weight: bold;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      margin-top: 1rem;
      transition: background-color 0.3s;
    }
    
    .google-btn:hover {
      background-color: #357ae8;
    }
    
    .divider {
      display: flex;
      align-items: center;
      text-align: center;
      margin: 1.5rem 0;
      color: #94a3b8;
    }
    
    .divider::before,
    .divider::after {
      content: '';
      flex: 1;
      border-bottom: 1px solid #4b5563;
    }
    
    .divider::before {
      margin-right: .5rem;
    }
    
    .divider::after {
      margin-left: .5rem;
    }
    
    main {
      flex: 1;
      padding: 2rem;
      max-width: 1000px;
      margin: 0 auto;
      width: 100%;
    }
    
    .welcome-section {
      background-color: rgba(255, 255, 255, 0.1);
      padding: 2rem;
      border-radius: 10px;
      margin-bottom: 2rem;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
      backdrop-filter: blur(10px);
    }
    
    .welcome-section h3 {
      color: #f8fafc;
      margin-bottom: 1rem;
      font-size: 1.5rem;
    }
    
    .welcome-section p {
      color: #cbd5e1;
      line-height: 1.6;
    }
    
    .dashboard {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 1.5rem;
    }
    
    .card {
      background-color: rgba(255, 255, 255, 0.1);
      padding: 1.5rem;
      border-radius: 10px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
      backdrop-filter: blur(10px);
    }
    
    .card h4 {
      color: #f8fafc;
      margin-bottom: 1rem;
      font-size: 1.2rem;
    }
    
    .card p {
      color: #cbd5e1;
    }
    
    .hidden {
      display: none;
    }
    
    .user-info {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .user-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
    }
    
    @media (max-width: 768px) {
      .login-container {
        margin: 1rem;
        padding: 1.5rem;
      }
      
      .navbar {
        padding: 1rem;
      }
      
      main {
        padding: 1rem;
      }
      
      .dashboard {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <!-- Página de Login -->
  <div id="login-page">
    <div class="login-container">
      <h2>Portal do Aluno - Villa Metal</h2>
      
      <!-- Login com Google -->
      <div>
        <h3>Entrar com Google</h3>
        <button class="google-btn" id="google-login">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 186.69 190.5">
            <path fill="#4285f4" d="M95.25 77.932v36.888h51.262c-2.251 11.863-9.006 21.908-19.137 28.662l30.913 23.986c18.204-16.831 28.693-41.618 28.693-70.548 0-6.51-.599-13.01-1.78-19.218H95.25z"/>
            <path fill="#34a853" d="M41.869 112.438c-4.028-4.028-6.76-8.98-8.196-14.38H5.492v29.688c7.515 14.97 19.144 26.592 34.377 33.358l27.08-21.005c-7.513-5.031-12.62-12.54-14.38-21.005-1.76-8.465-.3-17.31 4.028-24.345z"/>
            <path fill="#fbbc05" d="M95.25 37.888c13.24 0 25.083 4.569 34.623 13.512l25.994-25.994C142.635 12.68 120.553 4.5 95.25 4.5 58.963 4.5 27.326 24.374 10.714 54.862l31.401 24.396c10.19-30.368 39.04-51.87 73.135-51.87z"/>
            <path fill="#ea4335" d="M95.25 143.812c16.482 0 31.547-5.92 43.162-15.677l-25.993-25.994c-5.92 3.89-13.212 6.01-20.87 6.01-15.078 0-28.062-9.289-33.242-22.515l-31.4 24.396c14.38 28.662 43.162 47.78 76.343 47.78 12.61 0 24.045-2.69 34.623-7.515-4.569-3.29-9.889-8.196-14.379-12.68l-20.87 15.677c-6.31 4.569-14.08 7.515-22.242 7.515z"/>
          </svg>
          Entrar com Google
        </button>
      </div>
      
      <div class="divider">ou</div>
      
      <!-- Login com email/senha -->
      <form id="login-form">
        <h3>Entrar com E-mail</h3>
        <input type="email" id="login-email" placeholder="E-mail" required>
        <input type="password" id="login-password" placeholder="Senha" required>
        <button type="submit">Login</button>
      </form>
      
      <div class="divider">ou</div>
      
      <!-- Cadastro com email/senha -->
      <form id="register-form">
        <h3>Criar Conta</h3>
        <input type="text" id="register-name" placeholder="Nome completo" required>
        <input type="email" id="register-email" placeholder="E-mail" required>
        <input type="password" id="register-password" placeholder="Senha (mínimo 6 caracteres)" required>
        <button type="submit">Cadastrar</button>
      </form>
    </div>
  </div>
  
  <!-- Página do Portal (após login) -->
  <div id="portal-page" class="hidden">
    <nav class="navbar">
      <h2>Portal do Aluno - Villa Metal</h2>
      <div class="user-info">
        <img id="user-avatar" class="user-avatar" src="" alt="Avatar">
        <button id="logout-btn">Sair</button>
      </div>
    </nav>
    
    <main>
      <div class="welcome-section">
        <h3>Bem-vindo, <span id="student-name"></span>!</h3>
        <p>Aqui você terá acesso à sua frequência, histórico e comunicados da prática de conjunto Villa Metal.</p>
      </div>
      
      <div class="dashboard">
        <div class="card">
          <h4>Frequência</h4>
          <p>Visualize seu histórico de presenças e faltas nas aulas.</p>
        </div>
        
        <div class="card">
          <h4>Repertório</h4>
          <p>Acesse as músicas que estamos trabalhando no Villa Metal.</p>
        </div>
        
        <div class="card">
          <h4>Comunicados</h4>
          <p>Fique por dentro dos avisos e novidades.</p>
        </div>
        
        <div class="card">
          <h4>Agenda</h4>
          <p>Confira os próximos ensaios e apresentações.</p>
        </div>
      </div>
    </main>
  </div>

  <script>
    // Configuração do Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyDYToHqDE7kC4Onprf5U7aW7RLXBOLpJx8",
      authDomain: "villa-metal.firebaseapp.com",
      projectId: "villa-metal",
      storageBucket: "villa-metal.firebasestorage.app",
      messagingSenderId: "622030637005",
      appId: "1:622030637005:web:5d2e5203a64f4cc35ba684"
    };
    
    // Inicializar Firebase
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();
    
    // Elementos da DOM
    const loginPage = document.getElementById('login-page');
    const portalPage = document.getElementById('portal-page');
    const loginForm = document.getElementById('login-form');
    const registerForm = document.getElementById('register-form');
    const googleLoginBtn = document.getElementById('google-login');
    const logoutBtn = document.getElementById('logout-btn');
    const studentName = document.getElementById('student-name');
    const userAvatar = document.getElementById('user-avatar');
    
    // Observador de estado de autenticação
    auth.onAuthStateChanged((user) => {
      if (user) {
        // Usuário está logado
        showPortalPage(user);
      } else {
        // Usuário não está logado
        showLoginPage();
      }
    });
    
    // Login com Google
    googleLoginBtn.addEventListener('click', () => {
      const provider = new firebase.auth.GoogleAuthProvider();
      auth.signInWithPopup(provider)
        .then((result) => {
          // Login bem-sucedido
          console.log('Usuário logado com Google:', result.user);
        })
        .catch((error) => {
          console.error('Erro no login com Google:', error);
          alert('Erro ao fazer login com Google: ' + error.message);
        });
    });
    
    // Login com email/senha
    loginForm.addEventListener('submit', (e) => {
      e.preventDefault();
      const email = document.getElementById('login-email').value;
      const password = document.getElementById('login-password').value;
      
      auth.signInWithEmailAndPassword(email, password)
        .then((userCredential) => {
          // Login bem-sucedido
          console.log('Usuário logado com email/senha:', userCredential.user);
        })
        .catch((error) => {
          console.error('Erro no login:', error);
          alert('Erro ao fazer login: ' + error.message);
        });
    });
    
    // Cadastro com email/senha
    registerForm.addEventListener('submit', (e) => {
      e.preventDefault();
      const name = document.getElementById('register-name').value;
      const email = document.getElementById('register-email').value;
      const password = document.getElementById('register-password').value;
      
      auth.createUserWithEmailAndPassword(email, password)
        .then((userCredential) => {
          // Usuário criado com sucesso
          const user = userCredential.user;
          
          // Adicionar nome do usuário ao perfil
          return user.updateProfile({
            displayName: name
          });
        })
        .then(() => {
          console.log('Usuário criado com sucesso');
        })
        .catch((error) => {
          console.error('Erro no cadastro:', error);
          alert('Erro ao criar conta: ' + error.message);
        });
    });
    
    // Logout
    logoutBtn.addEventListener('click', () => {
      auth.signOut()
        .then(() => {
          console.log('Usuário deslogado');
        })
        .catch((error) => {
          console.error('Erro ao fazer logout:', error);
        });
    });
    
    // Mostrar página do portal
    function showPortalPage(user) {
      loginPage.classList.add('hidden');
      portalPage.classList.remove('hidden');
      
      // Exibir informações do usuário
      studentName.textContent = user.displayName || user.email;
      
      // Exibir avatar (se disponível)
      if (user.photoURL) {
        userAvatar.src = user.photoURL;
      } else {
        // Avatar padrão baseado na primeira letra do nome
        const initials = user.displayName ? user.displayName.charAt(0).toUpperCase() : user.email.charAt(0).toUpperCase();
        userAvatar.src = `https://ui-avatars.com/api/?name=${initials}&background=dc2626&color=fff&size=40`;
      }
    }
    
    // Mostrar página de login
    function showLoginPage() {
      portalPage.classList.add('hidden');
      loginPage.classList.remove('hidden');
      
      // Limpar formulários
      loginForm.reset();
      registerForm.reset();
    }
  </script>
</body>
</html>